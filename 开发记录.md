 # 一.	

在配置过滤器的时候从session中拿去用户写错，employee写成emplooyee
![reggie](./img/1.png)

# 二.

&emsp;&emsp; 在整理增加异常是，写错错误信息contains方法中包含Duplicate  entry中间有空格
![reggie](./img/2.png)

# 三.

1. 做分页查询时：前端页面的最大分页不光显示要改，vue里面的初值也要更改
![reggie](./img/3.png)
![reggie](./img/4.png)

2. 后端在书写时要判断搜索的name是不是问空，因为isNotEmpty被舍弃的，isNotEmpty过时了，所以学会了新的方法hasTest，此方法判断字符串 不是 null ，并且不为空，而且不能是空白字符，只有这三个条件同时满足时才 返回 true ，其他情况均返回 false
   + 也可以使用import org.apache.commons.lang.StringUtils;这个包的isNotEmpty方法

3. 前端vue中，分页需要的数据records和total是从后端分页插件中传送过来的
![reggie](./img/5.png)
![reggie](./img/6.png)

4. 修改员工状态，因为是雪花算法生成的ID所以js在解析的时候会丢失精度所以需要引入对象映射器

```java
import com.fasterxml.jackson.databind.DeserializationFeature;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.module.SimpleModule;
import com.fasterxml.jackson.databind.ser.std.ToStringSerializer;
import com.fasterxml.jackson.datatype.jsr310.deser.LocalDateDeserializer;
import com.fasterxml.jackson.datatype.jsr310.deser.LocalDateTimeDeserializer;
import com.fasterxml.jackson.datatype.jsr310.deser.LocalTimeDeserializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateSerializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalDateTimeSerializer;
import com.fasterxml.jackson.datatype.jsr310.ser.LocalTimeSerializer;
import java.math.BigInteger;
import java.time.LocalDate;
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import static com.fasterxml.jackson.databind.DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES;

/**
 * 对象映射器:基于jackson将Java对象转为json，或者将json转为Java对象
 * 将JSON解析为Java对象的过程称为 [从JSON反序列化Java对象]
 * 从Java对象生成JSON的过程称为 [序列化Java对象到JSON]
 */
public class JacksonObjectMapper extends ObjectMapper {

    public static final String DEFAULT_DATE_FORMAT = "yyyy-MM-dd";
    public static final String DEFAULT_DATE_TIME_FORMAT = "yyyy-MM-dd HH:mm:ss";
    public static final String DEFAULT_TIME_FORMAT = "HH:mm:ss";

    public JacksonObjectMapper() {
        super();
        //收到未知属性时不报异常
        this.configure(FAIL_ON_UNKNOWN_PROPERTIES, false);

        //反序列化时，属性不存在的兼容处理
        this.getDeserializationConfig().withoutFeatures(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);


        SimpleModule simpleModule = new SimpleModule()
                .addDeserializer(LocalDateTime.class, new LocalDateTimeDeserializer(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))
                .addDeserializer(LocalDate.class, new LocalDateDeserializer(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))
                .addDeserializer(LocalTime.class, new LocalTimeDeserializer(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)))

                .addSerializer(BigInteger.class, ToStringSerializer.instance)
                .addSerializer(Long.class, ToStringSerializer.instance)
                .addSerializer(LocalDateTime.class, new LocalDateTimeSerializer(DateTimeFormatter.ofPattern(DEFAULT_DATE_TIME_FORMAT)))
                .addSerializer(LocalDate.class, new LocalDateSerializer(DateTimeFormatter.ofPattern(DEFAULT_DATE_FORMAT)))
                .addSerializer(LocalTime.class, new LocalTimeSerializer(DateTimeFormatter.ofPattern(DEFAULT_TIME_FORMAT)));

        //注册功能模块 例如，可以添加自定义序列化器和反序列化器
        this.registerModule(simpleModule);
    }
}
```

然后拓展mvc的框架，加入消息转换器 
![reggie](./img/7.png)

# 四.公共字段填充
1. 删除掉原本的公共字段
![reggie](./img/8.png)

2. 创建公共填充的类
![reggie](./img/9.png)

3. 基于ThreadLocal封装工具类，用户保存和获取当前登录用户id，在同一次调用中，线程是同一个
![reggie](./img/10.png)
 
**<font color="red" >注：要提取为公共字段，应该先给要提取的字段加上</font>**'
> @TableField注解
![reggie](./img/11.png) 

4. bug  提取公共字段时：update_user为空异常，原因是书写的线程路径没有起到作用
![reggie](./img/12.png)
没有跳转到提取公共字段的类里，改正方法暂无（可能因为主启动类没有写@ServletComponentScan注解，待测试---测试完成，情况属实）。
![reggie](./img/13.png)
 
# 5. 分类管理
+ 分类管理时，因为套餐没有增加查询条件所以，删除一直失败
![reggie](./img/14.png)

+ 把查询出来的条件增加进去
![reggie](./img/15.png)

# 6. 文件上传时
    1）.必须采用post方式提交数据，method=”post”;
    2）.必须用multipart格式上传文件，enctype=”multipart/form-data”；
    3）.使用input的file控件上传，type=”file”；
    4）.指定文件路径时，最后加\\
![reggie](./img/15.png)
    5）.在写上传文件的代码时，参数传递必须使file
    6.. 下载文件关闭流时，最好放在finally中，不管程序出没出现异常都可以正常关闭，节省资源

**<font color="red" size="5">注菜品管理的删除，批量删除，停售，起售待开发</font>**

# 七.套餐管理
+ 因为要操作两个表，所以要开启事务管理
![reggie](./img/17.png)

+ 写完新增套餐的主题逻辑之后，测试发现菜品不能回显
![reggie](./img/18.png)

+ 要在菜品管理的controller里完善新增套餐的请求
![reggie](./img/19.png)

+ 因为菜品有个售卖转态，所以再查询的时候也要添加上查询当前售卖转态 
![reggie](./img/20.png)

+ 套餐管理中的分页查询返回的是那个代理对象，因为要返回套餐的名字
![reggie](./img/21.png)

+ 删除套餐中，因为id是长整形要用Long接受
**注：泛型中不能用基本数据类型所以要用Long来接受，虚拟机在编译时会把带泛型的转换成Object类型，而基本数据类型不属于Object 所以不能装**
![reggie](./img/22.png)

**<font color="red" size="5">注：套餐中的修改，停售，起售待开发</font>**

# 八、客户端开发
## 1.邮件登录




